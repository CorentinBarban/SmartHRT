id: 017
title: "Format et structure des release notes"
status: "Accept√©"
date: "2026-01-24"
type: "Processus"
context: |
  SmartHRT est une int√©gration Home Assistant qui √©volue rapidement avec des corrections de bugs,
  nouvelles fonctionnalit√©s, et changements architecturaux (ADR). Les utilisateurs ont besoin de
  comprendre rapidement :
  - Ce qui a chang√© entre les versions
  - Les √©ventuels breaking changes n√©cessitant des actions
  - Les nouvelles fonctionnalit√©s disponibles
  - Les bugs corrig√©s

  Sans format standardis√©, les release notes deviennent incoh√©rentes et difficiles √† exploiter.
decision: |
  Adoption d'un format structur√© pour les release notes, inspir√© de "Keep a Changelog" avec
  des adaptations sp√©cifiques aux int√©grations Home Assistant.

  **Structure obligatoire :**

  ```markdown
  # Version X.Y.Z - YYYY-MM-DD

  ## üö® Breaking Changes
  [Si applicable - section obligatoire m√™me si vide avec "Aucun"]

  - Description du changement incompatible
  - Action requise pour l'utilisateur

  ## ‚ú® Nouvelles fonctionnalit√©s

  - Description de la fonctionnalit√©
  - R√©f√©rence ADR si applicable (ADR-XXX)

  ## üêõ Corrections de bugs

  - Description du bug corrig√©
  - Impact sur l'utilisateur

  ## üîß Am√©liorations techniques

  - Refactoring, optimisations, am√©liorations internes
  - R√©f√©rence ADR si applicable

  ## üìö Documentation

  - Mises √† jour de la documentation
  - Nouveaux exemples

  ## ‚ö†Ô∏è Deprecated (si applicable)

  - Fonctionnalit√©s marqu√©es comme obsol√®tes
  - Date de suppression pr√©vue
  ```

  **R√®gles de r√©daction :**

  1. **Langage clair** : √âcrire pour l'utilisateur final, pas pour les d√©veloppeurs
  2. **Actions concr√®tes** : Pour les breaking changes, indiquer exactement quoi faire
  3. **R√©f√©rences** : Lier aux ADR, issues GitHub, ou pull requests concern√©s
  4. **Emojis** : Utiliser des emojis pour faciliter le scan visuel
  5. **Ordre chronologique** : Version la plus r√©cente en haut

  **Exemples de breaking changes :**
  - ‚úÖ "Les entit√©s `time.recoverystart_hour` et `time.recoveryupdate_hour` sont supprim√©es. 
       Utilisez `sensor.*_recovery_start` √† la place dans vos automatisations."
  - ‚ùå "Suppression de entit√©s time obsol√®tes"

  **Versioning s√©mantique :**
  - **MAJOR (X.0.0)** : Breaking changes
  - **MINOR (X.Y.0)** : Nouvelles fonctionnalit√©s (r√©trocompatibles)
  - **PATCH (X.Y.Z)** : Corrections de bugs uniquement
consequences:
  positive:
    - Les utilisateurs comprennent imm√©diatement l'impact d'une mise √† jour
    - Facilite la d√©cision de mettre √† jour ou d'attendre
    - Am√©liore la confiance dans l'int√©gration (transparence)
    - R√©duit les issues GitHub li√©es aux breaking changes non document√©s
    - Format structur√© facilite l'automatisation (changelog automatique)
  negative:
    - Temps suppl√©mentaire lors de la pr√©paration d'une release
    - N√©cessite discipline pour maintenir le format
  mitigation:
    - Template de release notes dans le d√©p√¥t (RELEASE_TEMPLATE.md)
    - Checklist pr√©-release incluant la v√©rification des notes
    - G√©n√©ration semi-automatique √† partir des commits conventionnels
references:
  - "Keep a Changelog: https://keepachangelog.com/"
  - "Semantic Versioning: https://semver.org/"
  - "Home Assistant release notes guidelines"
examples:
  - |
    # Version 2.1.0 - 2026-01-24

    ## üö® Breaking Changes

    **Suppression des entit√©s time en lecture seule (ADR-016)**
    - Les entit√©s `time.<name>_recoverystart_hour` et `time.<name>_recoveryupdate_hour` 
      sont supprim√©es et remplac√©es par des sensors timestamp.
    - **Action requise** : Mettez √† jour vos automatisations pour utiliser :
      - `sensor.<name>_recovery_start` au lieu de `time.<name>_recoverystart_hour`
    - Le nettoyage est automatique au rechargement de l'int√©gration.

    ## ‚ú® Nouvelles fonctionnalit√©s

    **Sensors timestamp pour automatisations (ADR-016)**
    - Nouveaux sensors utilisables comme d√©clencheurs avec `platform: time`:
      - `sensor.<name>_recovery_start` - Heure de relance du chauffage
      - `sensor.<name>_target_hour` - Heure cible/r√©veil
      - `sensor.<name>_recoverycalc_hour` - Heure de coupure chauffage
    - Exemple d'utilisation :
      ```yaml
      automation:
        trigger:
          - platform: time
            at: sensor.smarthrt_recovery_start
      ```

    ## üêõ Corrections de bugs

    **Correction du calcul de temp√©rature ressentie (ADR-015)**
    - Le seuil de vent pour activer le windchill est maintenant exactement 
      1.34 m/s (au lieu de 1.33 m/s approximatif)
    - Impact : Calculs de temp√©rature ressentie plus pr√©cis selon la formule JAG/TI

    ## üîß Am√©liorations techniques

    - Suppression de la duplication entre entit√©s `time.*` et `sensor.*_timestamp`
    - Nettoyage automatique des entit√©s obsol√®tes du registre (ADR-016)
    - Standardisation des unit√©s de vitesse du vent en m/s (ADR-015)

    ## üìö Documentation

    - Ajout de l'ADR-015 sur les unit√©s de vitesse du vent
    - Ajout de l'ADR-016 sur les sensors timestamp
    - Mise √† jour du README avec exemples d'automatisations corrig√©s
